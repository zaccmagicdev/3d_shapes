{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/FlyControls.js"],
  "sourcesContent": ["import {\n\tControls,\n\tQuaternion,\n\tVector3\n} from 'three';\n\nconst _changeEvent = { type: 'change' };\n\nconst _EPS = 0.000001;\nconst _tmpQuaternion = new Quaternion();\n\nclass FlyControls extends Controls {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper( object, domElement );\n\n\t\tthis.movementSpeed = 1.0;\n\t\tthis.rollSpeed = 0.005;\n\n\t\tthis.dragToLook = false;\n\t\tthis.autoForward = false;\n\n\t\t// internals\n\n\t\tthis._moveState = { up: 0, down: 0, left: 0, right: 0, forward: 0, back: 0, pitchUp: 0, pitchDown: 0, yawLeft: 0, yawRight: 0, rollLeft: 0, rollRight: 0 };\n\t\tthis._moveVector = new Vector3( 0, 0, 0 );\n\t\tthis._rotationVector = new Vector3( 0, 0, 0 );\n\t\tthis._lastQuaternion = new Quaternion();\n\t\tthis._lastPosition = new Vector3();\n\t\tthis._status = 0;\n\n\t\t// event listeners\n\n\t\tthis._onKeyDown = onKeyDown.bind( this );\n\t\tthis._onKeyUp = onKeyUp.bind( this );\n\t\tthis._onPointerMove = onPointerMove.bind( this );\n\t\tthis._onPointerDown = onPointerDown.bind( this );\n\t\tthis._onPointerUp = onPointerUp.bind( this );\n\t\tthis._onPointerCancel = onPointerCancel.bind( this );\n\t\tthis._onContextMenu = onContextMenu.bind( this );\n\n\t\t//\n\n\t\tif ( domElement !== null ) {\n\n\t\t\tthis.connect();\n\n\t\t}\n\n\t}\n\n\tconnect() {\n\n\t\twindow.addEventListener( 'keydown', this._onKeyDown );\n\t\twindow.addEventListener( 'keyup', this._onKeyUp );\n\n\t\tthis.domElement.addEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.addEventListener( 'pointercancel', this._onPointerCancel );\n\t\tthis.domElement.addEventListener( 'contextmenu', this._onContextMenu );\n\n\t}\n\n\tdisconnect() {\n\n\t\twindow.removeEventListener( 'keydown', this._onKeyDown );\n\t\twindow.removeEventListener( 'keyup', this._onKeyUp );\n\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.removeEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.removeEventListener( 'pointercancel', this._onPointerCancel );\n\t\tthis.domElement.removeEventListener( 'contextmenu', this._onContextMenu );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.disconnect();\n\n\t}\n\n\tupdate( delta ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\tconst object = this.object;\n\n\t\tconst moveMult = delta * this.movementSpeed;\n\t\tconst rotMult = delta * this.rollSpeed;\n\n\t\tobject.translateX( this._moveVector.x * moveMult );\n\t\tobject.translateY( this._moveVector.y * moveMult );\n\t\tobject.translateZ( this._moveVector.z * moveMult );\n\n\t\t_tmpQuaternion.set( this._rotationVector.x * rotMult, this._rotationVector.y * rotMult, this._rotationVector.z * rotMult, 1 ).normalize();\n\t\tobject.quaternion.multiply( _tmpQuaternion );\n\n\t\tif (\n\t\t\tthis._lastPosition.distanceToSquared( object.position ) > _EPS ||\n\t\t\t8 * ( 1 - this._lastQuaternion.dot( object.quaternion ) ) > _EPS\n\t\t) {\n\n\t\t\tthis.dispatchEvent( _changeEvent );\n\t\t\tthis._lastQuaternion.copy( object.quaternion );\n\t\t\tthis._lastPosition.copy( object.position );\n\n\t\t}\n\n\t}\n\n\t// private\n\n\t_updateMovementVector() {\n\n\t\tconst forward = ( this._moveState.forward || ( this.autoForward && ! this._moveState.back ) ) ? 1 : 0;\n\n\t\tthis._moveVector.x = ( - this._moveState.left + this._moveState.right );\n\t\tthis._moveVector.y = ( - this._moveState.down + this._moveState.up );\n\t\tthis._moveVector.z = ( - forward + this._moveState.back );\n\n\t\t//console.log( 'move:', [ this._moveVector.x, this._moveVector.y, this._moveVector.z ] );\n\n\t}\n\n\t_updateRotationVector() {\n\n\t\tthis._rotationVector.x = ( - this._moveState.pitchDown + this._moveState.pitchUp );\n\t\tthis._rotationVector.y = ( - this._moveState.yawRight + this._moveState.yawLeft );\n\t\tthis._rotationVector.z = ( - this._moveState.rollRight + this._moveState.rollLeft );\n\n\t\t//console.log( 'rotate:', [ this._rotationVector.x, this._rotationVector.y, this._rotationVector.z ] );\n\n\t}\n\n\t_getContainerDimensions() {\n\n\t\tif ( this.domElement != document ) {\n\n\t\t\treturn {\n\t\t\t\tsize: [ this.domElement.offsetWidth, this.domElement.offsetHeight ],\n\t\t\t\toffset: [ this.domElement.offsetLeft, this.domElement.offsetTop ]\n\t\t\t};\n\n\t\t} else {\n\n\t\t\treturn {\n\t\t\t\tsize: [ window.innerWidth, window.innerHeight ],\n\t\t\t\toffset: [ 0, 0 ]\n\t\t\t};\n\n\t\t}\n\n\t}\n\n}\n\nfunction onKeyDown( event ) {\n\n\tif ( event.altKey || this.enabled === false ) {\n\n\t\treturn;\n\n\t}\n\n\tswitch ( event.code ) {\n\n\t\tcase 'ShiftLeft':\n\t\tcase 'ShiftRight': this.movementSpeedMultiplier = .1; break;\n\n\t\tcase 'KeyW': this._moveState.forward = 1; break;\n\t\tcase 'KeyS': this._moveState.back = 1; break;\n\n\t\tcase 'KeyA': this._moveState.left = 1; break;\n\t\tcase 'KeyD': this._moveState.right = 1; break;\n\n\t\tcase 'KeyR': this._moveState.up = 1; break;\n\t\tcase 'KeyF': this._moveState.down = 1; break;\n\n\t\tcase 'ArrowUp': this._moveState.pitchUp = 1; break;\n\t\tcase 'ArrowDown': this._moveState.pitchDown = 1; break;\n\n\t\tcase 'ArrowLeft': this._moveState.yawLeft = 1; break;\n\t\tcase 'ArrowRight': this._moveState.yawRight = 1; break;\n\n\t\tcase 'KeyQ': this._moveState.rollLeft = 1; break;\n\t\tcase 'KeyE': this._moveState.rollRight = 1; break;\n\n\t}\n\n\tthis._updateMovementVector();\n\tthis._updateRotationVector();\n\n}\n\nfunction onKeyUp( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tswitch ( event.code ) {\n\n\t\tcase 'ShiftLeft':\n\t\tcase 'ShiftRight': this.movementSpeedMultiplier = 1; break;\n\n\t\tcase 'KeyW': this._moveState.forward = 0; break;\n\t\tcase 'KeyS': this._moveState.back = 0; break;\n\n\t\tcase 'KeyA': this._moveState.left = 0; break;\n\t\tcase 'KeyD': this._moveState.right = 0; break;\n\n\t\tcase 'KeyR': this._moveState.up = 0; break;\n\t\tcase 'KeyF': this._moveState.down = 0; break;\n\n\t\tcase 'ArrowUp': this._moveState.pitchUp = 0; break;\n\t\tcase 'ArrowDown': this._moveState.pitchDown = 0; break;\n\n\t\tcase 'ArrowLeft': this._moveState.yawLeft = 0; break;\n\t\tcase 'ArrowRight': this._moveState.yawRight = 0; break;\n\n\t\tcase 'KeyQ': this._moveState.rollLeft = 0; break;\n\t\tcase 'KeyE': this._moveState.rollRight = 0; break;\n\n\t}\n\n\tthis._updateMovementVector();\n\tthis._updateRotationVector();\n\n}\n\nfunction onPointerDown( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( this.dragToLook ) {\n\n\t\tthis._status ++;\n\n\t} else {\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0: this._moveState.forward = 1; break;\n\t\t\tcase 2: this._moveState.back = 1; break;\n\n\t\t}\n\n\t\tthis._updateMovementVector();\n\n\t}\n\n}\n\nfunction onPointerMove( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( ! this.dragToLook || this._status > 0 ) {\n\n\t\tconst container = this._getContainerDimensions();\n\t\tconst halfWidth = container.size[ 0 ] / 2;\n\t\tconst halfHeight = container.size[ 1 ] / 2;\n\n\t\tthis._moveState.yawLeft = - ( ( event.pageX - container.offset[ 0 ] ) - halfWidth ) / halfWidth;\n\t\tthis._moveState.pitchDown = ( ( event.pageY - container.offset[ 1 ] ) - halfHeight ) / halfHeight;\n\n\t\tthis._updateRotationVector();\n\n\t}\n\n}\n\nfunction onPointerUp( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( this.dragToLook ) {\n\n\t\tthis._status --;\n\n\t\tthis._moveState.yawLeft = this._moveState.pitchDown = 0;\n\n\t} else {\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0: this._moveState.forward = 0; break;\n\t\t\tcase 2: this._moveState.back = 0; break;\n\n\t\t}\n\n\t\tthis._updateMovementVector();\n\n\t}\n\n\tthis._updateRotationVector();\n\n}\n\nfunction onPointerCancel() {\n\n\tif ( this.enabled === false ) return;\n\n\tif ( this.dragToLook ) {\n\n\t\tthis._status = 0;\n\n\t\tthis._moveState.yawLeft = this._moveState.pitchDown = 0;\n\n\t} else {\n\n\t\tthis._moveState.forward = 0;\n\t\tthis._moveState.back = 0;\n\n\t\tthis._updateMovementVector();\n\n\t}\n\n\tthis._updateRotationVector();\n\n}\n\nfunction onContextMenu( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tevent.preventDefault();\n\n}\n\nexport { FlyControls };\n"],
  "mappings": ";;;;;;;AAMA,IAAM,eAAe,EAAE,MAAM,SAAS;AAEtC,IAAM,OAAO;AACb,IAAM,iBAAiB,IAAI,WAAW;AAEtC,IAAM,cAAN,cAA0B,SAAS;AAAA,EAElC,YAAa,QAAQ,aAAa,MAAO;AAExC,UAAO,QAAQ,UAAW;AAE1B,SAAK,gBAAgB;AACrB,SAAK,YAAY;AAEjB,SAAK,aAAa;AAClB,SAAK,cAAc;AAInB,SAAK,aAAa,EAAE,IAAI,GAAG,MAAM,GAAG,MAAM,GAAG,OAAO,GAAG,SAAS,GAAG,MAAM,GAAG,SAAS,GAAG,WAAW,GAAG,SAAS,GAAG,UAAU,GAAG,UAAU,GAAG,WAAW,EAAE;AACzJ,SAAK,cAAc,IAAI,QAAS,GAAG,GAAG,CAAE;AACxC,SAAK,kBAAkB,IAAI,QAAS,GAAG,GAAG,CAAE;AAC5C,SAAK,kBAAkB,IAAI,WAAW;AACtC,SAAK,gBAAgB,IAAI,QAAQ;AACjC,SAAK,UAAU;AAIf,SAAK,aAAa,UAAU,KAAM,IAAK;AACvC,SAAK,WAAW,QAAQ,KAAM,IAAK;AACnC,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAC/C,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAC/C,SAAK,eAAe,YAAY,KAAM,IAAK;AAC3C,SAAK,mBAAmB,gBAAgB,KAAM,IAAK;AACnD,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAI/C,QAAK,eAAe,MAAO;AAE1B,WAAK,QAAQ;AAAA,IAEd;AAAA,EAED;AAAA,EAEA,UAAU;AAET,WAAO,iBAAkB,WAAW,KAAK,UAAW;AACpD,WAAO,iBAAkB,SAAS,KAAK,QAAS;AAEhD,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AACrE,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AACrE,SAAK,WAAW,iBAAkB,aAAa,KAAK,YAAa;AACjE,SAAK,WAAW,iBAAkB,iBAAiB,KAAK,gBAAiB;AACzE,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AAAA,EAEtE;AAAA,EAEA,aAAa;AAEZ,WAAO,oBAAqB,WAAW,KAAK,UAAW;AACvD,WAAO,oBAAqB,SAAS,KAAK,QAAS;AAEnD,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AACxE,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AACxE,SAAK,WAAW,oBAAqB,aAAa,KAAK,YAAa;AACpE,SAAK,WAAW,oBAAqB,iBAAiB,KAAK,gBAAiB;AAC5E,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AAAA,EAEzE;AAAA,EAEA,UAAU;AAET,SAAK,WAAW;AAAA,EAEjB;AAAA,EAEA,OAAQ,OAAQ;AAEf,QAAK,KAAK,YAAY,MAAQ;AAE9B,UAAM,SAAS,KAAK;AAEpB,UAAM,WAAW,QAAQ,KAAK;AAC9B,UAAM,UAAU,QAAQ,KAAK;AAE7B,WAAO,WAAY,KAAK,YAAY,IAAI,QAAS;AACjD,WAAO,WAAY,KAAK,YAAY,IAAI,QAAS;AACjD,WAAO,WAAY,KAAK,YAAY,IAAI,QAAS;AAEjD,mBAAe,IAAK,KAAK,gBAAgB,IAAI,SAAS,KAAK,gBAAgB,IAAI,SAAS,KAAK,gBAAgB,IAAI,SAAS,CAAE,EAAE,UAAU;AACxI,WAAO,WAAW,SAAU,cAAe;AAE3C,QACC,KAAK,cAAc,kBAAmB,OAAO,QAAS,IAAI,QAC1D,KAAM,IAAI,KAAK,gBAAgB,IAAK,OAAO,UAAW,KAAM,MAC3D;AAED,WAAK,cAAe,YAAa;AACjC,WAAK,gBAAgB,KAAM,OAAO,UAAW;AAC7C,WAAK,cAAc,KAAM,OAAO,QAAS;AAAA,IAE1C;AAAA,EAED;AAAA;AAAA,EAIA,wBAAwB;AAEvB,UAAM,UAAY,KAAK,WAAW,WAAa,KAAK,eAAe,CAAE,KAAK,WAAW,OAAW,IAAI;AAEpG,SAAK,YAAY,IAAM,CAAE,KAAK,WAAW,OAAO,KAAK,WAAW;AAChE,SAAK,YAAY,IAAM,CAAE,KAAK,WAAW,OAAO,KAAK,WAAW;AAChE,SAAK,YAAY,IAAM,CAAE,UAAU,KAAK,WAAW;AAAA,EAIpD;AAAA,EAEA,wBAAwB;AAEvB,SAAK,gBAAgB,IAAM,CAAE,KAAK,WAAW,YAAY,KAAK,WAAW;AACzE,SAAK,gBAAgB,IAAM,CAAE,KAAK,WAAW,WAAW,KAAK,WAAW;AACxE,SAAK,gBAAgB,IAAM,CAAE,KAAK,WAAW,YAAY,KAAK,WAAW;AAAA,EAI1E;AAAA,EAEA,0BAA0B;AAEzB,QAAK,KAAK,cAAc,UAAW;AAElC,aAAO;AAAA,QACN,MAAM,CAAE,KAAK,WAAW,aAAa,KAAK,WAAW,YAAa;AAAA,QAClE,QAAQ,CAAE,KAAK,WAAW,YAAY,KAAK,WAAW,SAAU;AAAA,MACjE;AAAA,IAED,OAAO;AAEN,aAAO;AAAA,QACN,MAAM,CAAE,OAAO,YAAY,OAAO,WAAY;AAAA,QAC9C,QAAQ,CAAE,GAAG,CAAE;AAAA,MAChB;AAAA,IAED;AAAA,EAED;AAED;AAEA,SAAS,UAAW,OAAQ;AAE3B,MAAK,MAAM,UAAU,KAAK,YAAY,OAAQ;AAE7C;AAAA,EAED;AAEA,UAAS,MAAM,MAAO;AAAA,IAErB,KAAK;AAAA,IACL,KAAK;AAAc,WAAK,0BAA0B;AAAI;AAAA,IAEtD,KAAK;AAAQ,WAAK,WAAW,UAAU;AAAG;AAAA,IAC1C,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IAEvC,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IACvC,KAAK;AAAQ,WAAK,WAAW,QAAQ;AAAG;AAAA,IAExC,KAAK;AAAQ,WAAK,WAAW,KAAK;AAAG;AAAA,IACrC,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IAEvC,KAAK;AAAW,WAAK,WAAW,UAAU;AAAG;AAAA,IAC7C,KAAK;AAAa,WAAK,WAAW,YAAY;AAAG;AAAA,IAEjD,KAAK;AAAa,WAAK,WAAW,UAAU;AAAG;AAAA,IAC/C,KAAK;AAAc,WAAK,WAAW,WAAW;AAAG;AAAA,IAEjD,KAAK;AAAQ,WAAK,WAAW,WAAW;AAAG;AAAA,IAC3C,KAAK;AAAQ,WAAK,WAAW,YAAY;AAAG;AAAA,EAE7C;AAEA,OAAK,sBAAsB;AAC3B,OAAK,sBAAsB;AAE5B;AAEA,SAAS,QAAS,OAAQ;AAEzB,MAAK,KAAK,YAAY,MAAQ;AAE9B,UAAS,MAAM,MAAO;AAAA,IAErB,KAAK;AAAA,IACL,KAAK;AAAc,WAAK,0BAA0B;AAAG;AAAA,IAErD,KAAK;AAAQ,WAAK,WAAW,UAAU;AAAG;AAAA,IAC1C,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IAEvC,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IACvC,KAAK;AAAQ,WAAK,WAAW,QAAQ;AAAG;AAAA,IAExC,KAAK;AAAQ,WAAK,WAAW,KAAK;AAAG;AAAA,IACrC,KAAK;AAAQ,WAAK,WAAW,OAAO;AAAG;AAAA,IAEvC,KAAK;AAAW,WAAK,WAAW,UAAU;AAAG;AAAA,IAC7C,KAAK;AAAa,WAAK,WAAW,YAAY;AAAG;AAAA,IAEjD,KAAK;AAAa,WAAK,WAAW,UAAU;AAAG;AAAA,IAC/C,KAAK;AAAc,WAAK,WAAW,WAAW;AAAG;AAAA,IAEjD,KAAK;AAAQ,WAAK,WAAW,WAAW;AAAG;AAAA,IAC3C,KAAK;AAAQ,WAAK,WAAW,YAAY;AAAG;AAAA,EAE7C;AAEA,OAAK,sBAAsB;AAC3B,OAAK,sBAAsB;AAE5B;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,YAAY,MAAQ;AAE9B,MAAK,KAAK,YAAa;AAEtB,SAAK;AAAA,EAEN,OAAO;AAEN,YAAS,MAAM,QAAS;AAAA,MAEvB,KAAK;AAAG,aAAK,WAAW,UAAU;AAAG;AAAA,MACrC,KAAK;AAAG,aAAK,WAAW,OAAO;AAAG;AAAA,IAEnC;AAEA,SAAK,sBAAsB;AAAA,EAE5B;AAED;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,YAAY,MAAQ;AAE9B,MAAK,CAAE,KAAK,cAAc,KAAK,UAAU,GAAI;AAE5C,UAAM,YAAY,KAAK,wBAAwB;AAC/C,UAAM,YAAY,UAAU,KAAM,CAAE,IAAI;AACxC,UAAM,aAAa,UAAU,KAAM,CAAE,IAAI;AAEzC,SAAK,WAAW,UAAU,EAAM,MAAM,QAAQ,UAAU,OAAQ,CAAE,IAAM,aAAc;AACtF,SAAK,WAAW,aAAgB,MAAM,QAAQ,UAAU,OAAQ,CAAE,IAAM,cAAe;AAEvF,SAAK,sBAAsB;AAAA,EAE5B;AAED;AAEA,SAAS,YAAa,OAAQ;AAE7B,MAAK,KAAK,YAAY,MAAQ;AAE9B,MAAK,KAAK,YAAa;AAEtB,SAAK;AAEL,SAAK,WAAW,UAAU,KAAK,WAAW,YAAY;AAAA,EAEvD,OAAO;AAEN,YAAS,MAAM,QAAS;AAAA,MAEvB,KAAK;AAAG,aAAK,WAAW,UAAU;AAAG;AAAA,MACrC,KAAK;AAAG,aAAK,WAAW,OAAO;AAAG;AAAA,IAEnC;AAEA,SAAK,sBAAsB;AAAA,EAE5B;AAEA,OAAK,sBAAsB;AAE5B;AAEA,SAAS,kBAAkB;AAE1B,MAAK,KAAK,YAAY,MAAQ;AAE9B,MAAK,KAAK,YAAa;AAEtB,SAAK,UAAU;AAEf,SAAK,WAAW,UAAU,KAAK,WAAW,YAAY;AAAA,EAEvD,OAAO;AAEN,SAAK,WAAW,UAAU;AAC1B,SAAK,WAAW,OAAO;AAEvB,SAAK,sBAAsB;AAAA,EAE5B;AAEA,OAAK,sBAAsB;AAE5B;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,YAAY,MAAQ;AAE9B,QAAM,eAAe;AAEtB;",
  "names": []
}
